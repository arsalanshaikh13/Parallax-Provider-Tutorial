lint_and_test:
  stage: test
  rules:
    - if: '$CI_PIPELINE_SOURCE == "parent_pipeline"'
      when: on_success
    - when: never
  before_script:
    - yarn install --frozen-lockfile --ignore-scripts
  script:
    - yarn lint
    - yarn test
  coverage: /All files[^|]*|[^|]*\s+([\d\.]+)/
  artifacts:
    paths:
      - coverage/
    reports:
      coverage_report:
        coverage_format: cobertura
        path: coverage/clover.xml
    expire_in: 1 day
